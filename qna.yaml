version: 3
domain: Openshift Baremetal
created_by: willsparker
document_outline: |
  Red Hat OpenShift Container Platform v4.18 Bare Metal Cluster Installation Preparation.
seed_examples:
  - context: |
      ## CHAPTER 1. PREPARING FOR BARE METAL CLUSTER INSTALLATION
      ## 1.1. PREREQUISITES
      - You reviewed details about the OpenShift Container Platform installation and update processes.
      - You have read the documentation on selecting a cluster installation method and preparing it for users.
      ## 1.2. PLANNING A BARE METAL CLUSTER FOR OPENSHIFT VIRTUALIZATION
      If you will use OpenShift Virtualization, it is important to be aware of several requirements before you install your bare metal cluster.
      - If you want to use live migration features, you must have multiple worker nodes at the time of cluster installation . This is because live migration requires the cluster-level high availability (HA) flag to be set to true. The HA flag is set when a cluster is installed and cannot be changed afterwards. If there are fewer than two worker nodes defined when you install your cluster, the HA flag is set to false for the life of the cluster.
      You can install OpenShift Virtualization on a single-node cluster, but single-node OpenShift does not support high availability.
      - Live migration requires shared storage. Storage for OpenShift Virtualization must support and use the ReadWriteMany (RWX) access mode.
      - If you plan to use Single Root I/O Virtualization (SR-IOV), ensure that your network interface controllers (NICs) are supported by OpenShift Container Platform.
      ## Additional resources
      - Getting started with OpenShift Virtualization
      - Preparing your cluster for OpenShift Virtualization
      - About Single Root I/O Virtualization (SR-IOV) hardware networks
      - Connecting a virtual machine to an SR-IOV networkx
    questions_and_answers:
      - question: |
          Can Openshift Virtualization be installed on a single-node cluster?
        answer: |
          Yes, but it does not support high availability.
      - question: |
          What kind of storage does live migration require?
        answer: |
          Live migration requires shared storage. It must also support the ReadWriteMany (RWX) access mode.
      - question: |
          What do I need to be aware of when installing Openshift Virtualization on a bare metal cluster?
        answer: |
          You will have to have multiple worker nodes at the cluster installation time. This is because the cluster-level high availability flag (HA) flag must be set to true, to use live migration. 
  - context: |
      ## 1.3. NIC PARTITIONING FOR SR-IOV DEVICES

      OpenShift Container Platform can be deployed on a server with a dual port network interface card (NIC). You can partition a single, high-speed dual port NIC into multiple virtual functions (VFs) and enable SR-IOV.

      This feature supports the use of bonds for high availability with the Link Aggregation Control Protocol (LACP).

      Only one LACP can be declared by physical NIC.

      An OpenShift Container Platform cluster can be deployed on a bond interface with 2 VFs on 2 physical functions (PFs) using the following methods:

      - Agent-based installer

      The minimum required version of nmstate is:
        - 1.4.2-4 for RHEL 8 versions
        - 2.2.7 for RHEL 9 versions
        - Installer-provisioned infrastructure installation
        - User-provisioned infrastructure installation

      - Example: Bonds and SR-IOV dual-nic node network configuration
      - Optional: Configuring host network interfaces for dual port NIC
      - Bonding multiple SR-IOV network interfaces to a dual port NIC interface

    questions_and_answers:
      - question: |
          What is the minimum required version of nmstate, for RHEL9?
        answer: |
          nmstate v2.2.7
      - question: |
          How many LACP can be declared by physical NIC?
        answer: |
          Just one.
      - question: |
          What feature supports the use of bonds for HA with the LACP?
        answer: |
          SR-IOV with a single high-speed dual port NIC into multiple virtual functions.
  - context: |
      You can install a cluster on bare metal infrastructure that is provisioned by the OpenShift Container Platform installation program, by using the following method:
        - Installing an installer-provisioned cluster on bare metal : You can install OpenShift Container Platform on bare metal by using installer provisioning.
      You can install a cluster on bare metal infrastructure that you provision, by using one of the following methods:

        - Installing a user-provisioned cluster on bare metal : You can install OpenShift Container Platform on bare metal infrastructure that you provision. For a cluster that contains userprovisioned infrastructure, you must deploy all of the required machines.
        - Installing a user-provisioned bare metal cluster with network customizations : You can install a bare metal cluster on user-provisioned infrastructure with network-customizations. By customizing your network configuration, your cluster can coexist with existing IP address allocations in your environment and integrate with existing MTU and VXLAN configurations. Most of the network customizations must be applied at the installation stage.
        - Installing a user-provisioned bare metal cluster on a restricted network : You can install a user-provisioned bare metal cluster on a restricted or disconnected network by using a mirror registry. You can also use this installation method to ensure that your clusters only use container images that satisfy your organizational controls on external content.

    questions_and_answers:
      - question: |
          What distinguishes installer-provisioned from user-provisioned OpenShift installations on bare metal?
        answer: |
          Installer-provisioned installations let OpenShift handle the infrastructure setup, while user-provisioned installations require the user to manually deploy all machines. The former is more automated; the latter offers more control and flexibility.
      - question: |
          When would you use a user-provisioned bare metal cluster with network customizations?
        answer: |
          This method is used when the cluster must align with existing IP allocations, MTU, or VXLAN settings. Customizing the network during installation ensures compatibility with the organization's current infrastructure.
      - question: |
          How does installing on a restricted network support compliance?
        answer: |
          It enhances compliance by using a local mirror registry, ensuring the cluster only accesses vetted container images, which helps meet organizational or regulatory security requirements.
